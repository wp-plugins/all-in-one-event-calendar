jQuery(document).ready(function(i){if(ai1ec_calendar.selector!=undefined&&ai1ec_calendar.selector!=""&&i(ai1ec_calendar.selector).length==1){var n=i(":header:contains("+ai1ec_calendar.title+"):first");if(!n.length){n=i('<h1 class="page-title"></h1>');n.text(ai1ec_calendar.title)}var c=i("#ai1ec-container").detach().before(n);i(ai1ec_calendar.selector).empty().append(c).hide().css("visibility","visible").fadeIn("fast")}var h="";var l;var f=i("body").attr("class");if(f==undefined){f=""}if(f.match(/\s?\bai1ec-[\w-]+\b/)==null){f+=" "+ai1ec_calendar.body_class;i("body").attr("class",f)}function d(){var q=document.location.hash;var p=convertEntities(ai1ec_calendar.default_hash);if(h!=q&&(q!=""||h!=p)){var r=q;if(!r){r=p}j(r)}}setInterval(d,300);function j(p){i("#ai1ec-calendar-view-loading").fadeTo("fast",0.7,function(){var q=p.substring(1);i.getJSON(ai1ec_calendar.ajaxurl,q,function(t){var s=i("body").attr("class");s=s.replace(/\s?\bai1ec-[\w-]+\b/g,"");s+=" "+t.body_class;i("body").attr("class",s);var u=i("#ai1ec-calendar-view-container");u.height(u.height());var r=i("#ai1ec-calendar-view").html(t.html).height();u.animate({height:r},{complete:function(){u.height("auto")}});i("#ai1ec-calendar-view-loading").fadeOut("fast");o()})});h=p}i("a.ai1ec-load-view").live("click",function(){j(i(this).attr("href"))});function b(){var r=i(this).prev();if(!r.data("ai1ec_offset")){r.css("visibility","hidden").show();var q=i("#ai1ec-calendar-view-container");var u=r.width();var t=r.offset();var s=q.offset();var p=s.left+q.width();if(t.left+u>p){r.offset({left:p-u,top:t.top})}if(i(".ai1ec-event-summary",r).offset().left<s.left){r.addClass("ai1ec-shifted-right")}r.hide().css("visibility","visible");r.data("ai1ec_offset",true)}r.fadeIn(100,function(){if(!i(this).data("ai1ec_mouseinside")){i(this).each(e)}})}function e(){i(this).fadeOut(100,function(){i(this).parent().css({zIndex:"auto"})}).data("ai1ec_mouseinside",false)}i(".ai1ec-month-view .ai1ec-event").live("mouseenter",b);i(".ai1ec-month-view .ai1ec-event-popup").live("mouseleave",e).live("mousemove",function(){i(this).data("ai1ec_mouseinside",true)});if(i(".ai1ec-month-view").length){i(window).blur(function(){i(".ai1ec-event-popup:visible").each(e)})}function m(){i(this).hide().parent().addClass("ai1ec-expanded").end().prev().show().find(".ai1ec-event-description").hide().slideDown("fast")}function g(){i(this).next().slideUp("fast",function(){i(this).parent().parent().removeClass("ai1ec-expanded").end().hide().next().show()})}i(".ai1ec-agenda-view .ai1ec-event > .ai1ec-event-click").live("click",m);i(".ai1ec-agenda-view .ai1ec-event-summary > .ai1ec-event-click").live("click",g);i(".ai1ec-action-agenda #ai1ec-expand-all").live("click",function(){i(".ai1ec-event > .ai1ec-event-click:visible").click()});i(".ai1ec-action-agenda #ai1ec-collapse-all").live("click",function(){i(".ai1ec-event-summary > .ai1ec-event-click:visible").click()});element_selector(".ai1ec-category-filter-selector li","ai1ec-selected","ai1ec-categories","#ai1ec-selected-categories");element_selector(".ai1ec-tag-filter-selector li","ai1ec-selected","ai1ec-tags","#ai1ec-selected-tags");i(".ai1ec-dropdown").click(function(){i(".ai1ec-filter-selector").css("zIndex",10);var p=i(this).siblings(".ai1ec-filter-selector").css("zIndex",11);if(i(this).hasClass("ai1ec-active")){i(this).removeClass("ai1ec-active");p.slideUp(150)}else{i(this).addClass("ai1ec-active");p.slideDown(150)}});function k(){var s=new Array();selected_cats=i(".ai1ec-filters-container .ai1ec-dropdown.ai1ec-selected + #ai1ec-selected-categories").val();if(selected_cats){s.push(selected_cats);selected_cats="&ai1ec_cat_ids="+selected_cats}else{selected_cats=""}selected_tags=i(".ai1ec-filters-container .ai1ec-dropdown.ai1ec-selected + #ai1ec-selected-tags").val();if(selected_tags){s.push(selected_tags);selected_tags="&ai1ec_tag_ids="+selected_tags}else{selected_tags=""}s=s.join();var p;if(s.length){p=convertEntities(ai1ec_calendar.export_url)+selected_cats+selected_tags;i(".ai1ec-subscribe-filtered").fadeIn("fast")}else{p=convertEntities(ai1ec_calendar.export_url);i(".ai1ec-subscribe-filtered").fadeOut("fast")}i(".ai1ec-subscribe").attr("href",p);i(".ai1ec-subscribe-google").attr("href","http://www.google.com/calendar/render?cid="+escape(p.replace("webcal://","http://")));var r={action:"ai1ec_term_filter",ai1ec_post_ids:l,ai1ec_term_ids:s};var q=i("#ai1ec-calendar-view-loading").delay(500).fadeTo("fast",0.7);i.getJSON(ai1ec_calendar.ajaxurl,r,function(u){q.clearQueue().fadeOut("fast");var t=new Array();i.each(u.matching_ids,function(v,w){t.push(".ai1ec-event-id-"+w)});i(t.join()).fadeIn("fast");t=new Array();i.each(u.unmatching_ids,function(v,w){t.push(".ai1ec-event-id-"+w)});i(t.join()).fadeOut("fast")})}function a(){i(".ai1ec-filter-selector-container").each(function(){if(i("li.ai1ec-selected",this).length){i(".ai1ec-dropdown",this).addClass("ai1ec-selected")}else{i(".ai1ec-dropdown",this).removeClass("ai1ec-selected")}});if(i(".ai1ec-filters-container .ai1ec-selected").length){i(".ai1ec-clear-filters").fadeIn("fast")}else{i(".ai1ec-clear-filters").fadeOut("fast")}k()}i(".ai1ec-filter-selector li").click(a);i(".ai1ec-clear-filters").click(function(){i(".ai1ec-filter-selector-container li").removeClass("ai1ec-selected");a()});function o(){l=new Array();i(".ai1ec-post-id").each(function(){l.push(this.value)});l=l.join();if(i(".ai1ec-active-event:first").length){i(".ai1ec-month-view .ai1ec-active-event:first").each(function(){i(this).each(b).prev().data("ai1ec_mouseinside",true)});i(".ai1ec-agenda-view .ai1ec-active-event:first > .ai1ec-event-click").each(m);i.scrollTo(".ai1ec-active-event:first",1000,{offset:{left:0,top:-window.innerHeight/2+100}})}if(i(".ai1ec-dropdown.ai1ec-selected").length){i(".ai1ec-month-view .ai1ec-event-container, .ai1ec-agenda-view .ai1ec-event").hide();k()}}if(i("#ai1ec-selected-categories").val()!=""||i("#ai1ec-selected-tags").val()!=""){a()}o()});