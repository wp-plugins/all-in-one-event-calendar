(function(d){function a(g){g.addClass("error").fadeOut("normal",function(){g.val(g.data("timespan.stored")).removeClass("error").fadeIn("fast")})}function e(){d(this).data("timespan.stored",this.value)}function c(h,i,j,g){i.val(i.data("timespan.initial_value"));var k=parseInt(i.val());if(!isNaN(parseInt(k))){k=new Date(parseInt(k)*1000)}else{k=new Date(g)}h.val(formatDate(k,false));h.each(e)}var f={start_date_input:"date-input",start_time:"time",twentyfour_hour:false,now:new Date()};var b={init:function(i){var l=d.extend({},f,i);var j=d(l.start_date_input);var k=d(l.start_time);var h=j;var g=j;g.bind("focus.timespan",e);h.calendricalDate({today:new Date(l.now.getFullYear(),l.now.getMonth(),l.now.getDate())});h.bind("blur.timespan",function(){var m=parseDate(this.value,false);if(isNaN(m)){a(d(this))}else{d(this).data("timespan.stored",this.value);d(this).val(formatDate(m,false))}});j.bind("focus.timespan",function(){var m=parseDate(j.val(),false).getTime()/1000}).bind("blur.timespan",function(){var m=parseDate(j.data("timespan.stored"),false)});j.closest("form").bind("submit.timespan",function(){var m=parseDate(j.val(),false).getTime()/1000;if(isNaN(m)){m=""}k.val(m)});k.data("timespan.initial_value",k.val());c(j,k,l.twentyfour_hour,l.now);return this},reset:function(g){var h=d.extend({},f,g);c(d(h.start_date_input),d(h.start_time),h.twentyfour_hour,h.now);return this},destroy:function(g){g=d.extend({},f,g);d.each(g,function(i,h){d(h).unbind(".timespan")});d(g.start_date_input).closest("form").unbind(".timespan");return this}};d.inputdate=function(g){if(b[g]){return b[g].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof g==="object"||!g){return b.init.apply(this,arguments)}else{d.error("Method "+g+" does not exist on jQuery.timespan")}}}})(jQuery);